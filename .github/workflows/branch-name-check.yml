name: Branch name check

on:
  push:
    branches-ignore:
      - main
  pull_request:
    branches:
      - main

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Validate branch name
        env:
          GITHUB_REF_NAME: ${{ github.ref_name }}
        run: |
          echo "Branch: $GITHUB_REF_NAME"
          # 許容パターン: <type>/<issue>-<kebab>
          echo "$GITHUB_REF_NAME" | grep -Eq '^(feature|fix|docs|refactor|chore|test|build|ci)/[0-9]+-[a-z0-9]+(-[a-z0-9]+)*$' || {
            echo "::error::ブランチ名は <type>/<issue>-<kebab> 形式にしてください";
            echo "例: feature/123-board-generator";
            exit 1;
          }
